<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>SZzzT&#39;s Blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2019-07-14T14:41:41.170Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>SZzzT</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>XSS跨站脚本攻击</title>
    <link href="http://yoursite.com/2019/07/12/XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/"/>
    <id>http://yoursite.com/2019/07/12/XSS跨站脚本攻击/</id>
    <published>2019-07-12T11:01:27.000Z</published>
    <updated>2019-07-14T14:41:41.170Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="Test-1："><a href="#Test-1：" class="headerlink" title="Test 1："></a>Test 1：</h3><p>没有过滤，网页源码为</p><img src="/2019/07/12/XSS跨站脚本攻击/tu1.jpg" title="图1"><p>所以payload为: </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(123)&lt;/script&gt;</span><br></pre></td></tr></table></figure><img src="/2019/07/12/XSS跨站脚本攻击/tu2.jpg" title="图2"><h3 id="Test-2"><a href="#Test-2" class="headerlink" title="Test 2:"></a>Test 2:</h3><p>网页源代码为：<img src="/2019/07/12/XSS跨站脚本攻击/tu3.jpg" title="图3"></p><p>发现红框框起来的部分，需要闭合之前的尖括号和双引号，才能引起弹窗，达成跨站脚本攻击。</p><p>所以 payload为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;script&gt;alert(123)&lt;/script&gt;</span><br></pre></td></tr></table></figure><img src="/2019/07/12/XSS跨站脚本攻击/tu4.jpg" title="图4"><h3 id="Test-3："><a href="#Test-3：" class="headerlink" title="Test 3："></a>Test 3：</h3><p>网页源代码：</p><img src="/2019/07/12/XSS跨站脚本攻击/tu5.jpg" title="图5"><p>网页源码中，红框部分为主要部分，用了htmlspecialchars()函数。该函数的作用是将&lt; &gt; / “ “ ‘ ‘这些符号进行转义，并且2处都进行了转义，所以我们使用html事件属性。</p><p>我们使用鼠标事件来引起xss弹窗。但是我们首先要闭合之前的单引号。</p><p>所以payload为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos; onmouseover=&apos;alert(2333)，这是我们把鼠标移到搜索框附近就会引起弹窗，攻击成功</span><br></pre></td></tr></table></figure><img src="/2019/07/12/XSS跨站脚本攻击/tu6.jpg" title="图6">)<h3 id="Test-4："><a href="#Test-4：" class="headerlink" title="Test 4："></a>Test 4：</h3><p>与上一关不同的是，出现的第一处发生了htmlspecialchars()转义，第二处过滤了&lt;和&gt;两个符号（替换成空），并将value=后面的单引号换成了双引号。这样我们直接将上题Payload 中单引号换成双引号，最后鼠标滑过触发XSS 。</p><img src="/2019/07/12/XSS跨站脚本攻击/tu7.jpg" title="图7"><p>所以payload为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">”nmouseover=”lert(2333)</span><br></pre></td></tr></table></figure><img src="/2019/07/12/XSS跨站脚本攻击/tu8.jpg" title="图8"><h3 id="Test-5："><a href="#Test-5：" class="headerlink" title="Test 5："></a>Test 5：</h3><p>查看网页源代码发现on中间插入下划线_ ，并且发现script也被过滤，所以我们用html链接形式触发xss。首先我们闭合双引号，其次闭合尖括号；然后我们用链接触发xss。</p><img src="/2019/07/12/XSS跨站脚本攻击/tu9.jpg" title="图9"><p>所以payload为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;a href=&quot;javascript:alert(123)&quot;&gt; 然后点击。便可触发</span><br></pre></td></tr></table></figure><img src="/2019/07/12/XSS跨站脚本攻击/tu10.jpg" title="图10"><h3 id="Test-6："><a href="#Test-6：" class="headerlink" title="Test 6："></a>Test 6：</h3><p>首先我们用上次的payload尝试，发现不可行。查看网页源代码，发现有很多关键词都加入了下划线_ 进行了屏蔽，但是查看网页源码，发现我们之前填写的payload并没有被大小写统一，所以我们可以用大小写混用绕过屏蔽。</p><img src="/2019/07/12/XSS跨站脚本攻击/tu11.jpg" title="图11"><p><img src="file:///C:/Users/5454/AppData/Local/Temp/msohtmlclip1/01/clip_image024.jpg" alt="img"></p><p>所以payload为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;a hRef=&quot;javascript:alert(123)&quot;&gt; 并点击，便能触发xss</span><br></pre></td></tr></table></figure><img src="/2019/07/12/XSS跨站脚本攻击/tu12.jpg" title="图12"><h3 id="Test-7："><a href="#Test-7：" class="headerlink" title="Test 7："></a>Test 7：</h3><p>用之前的payload，发现并不能，然后查看网页源码。发现许多关键字被屏蔽了，并且被替换成空。我们可使用双写绕过，使得替换后的结果是我们所期望的。首先闭合双引号和尖括号，其次双写绕过。</p><img src="/2019/07/12/XSS跨站脚本攻击/tu13.jpg" title="图13">)<p>所以payload：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;a hrhrefef=&quot;javascrscriptipt:alert(123)&quot;&gt; 然后点击，触发弹窗</span><br></pre></td></tr></table></figure><img src="/2019/07/12/XSS跨站脚本攻击/tu14.jpg" title="图14">)<h3 id="Test-8："><a href="#Test-8：" class="headerlink" title="Test 8："></a>Test 8：</h3><p>算了，不尝试之前的payload了，反正就没对过，直接看网页源码吧。</p><img src="/2019/07/12/XSS跨站脚本攻击/tu15.jpg" title="图15">)<p>发现几乎所有关键字都被加了下划线_ 都被屏蔽，我们可以使用Unicode编码绕过。</p><p>Payload：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javascrip&amp;#116;:alert(123) 然后点击友情链接，便可以触发xss弹窗。</span><br></pre></td></tr></table></figure><img src="/2019/07/12/XSS跨站脚本攻击/tu16.jpg" title="图16"><h3 id="Test-9："><a href="#Test-9：" class="headerlink" title="Test 9："></a>Test 9：</h3><p>尝试之前的payload，发现404了，并为触发弹窗，攻击失败。查看源码，发现多了一个if判断语句。判断内容是是否含有http://，如果没有，就会显示连接不合法之类的。我们可以使用注释绕过</p><img src="/2019/07/12/XSS跨站脚本攻击/tu17.jpg" title="图17"><p>所以payload为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javascrip&amp;#116;:alert(123)/*http://*/</span><br></pre></td></tr></table></figure><img src="/2019/07/12/XSS跨站脚本攻击/tu20.jpg" title="图18"><h3 id="Test-10："><a href="#Test-10：" class="headerlink" title="Test 10："></a>Test 10：</h3><p>查看网页源码，发现有许多hidden隐藏项，我们可以利用sort函数，并且利用html事件触发来触发xss。</p><img src="/2019/07/12/XSS跨站脚本攻击/tu19.jpg" title="图19"><p>所以 payload为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;t_sort=&quot; onmouseover=&quot;alert(123)&quot; type=&quot;text</span><br></pre></td></tr></table></figure><img src="/2019/07/12/XSS跨站脚本攻击/tu20.jpg" title="图20">]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
      <category term="网络攻防 - XSS" scheme="http://yoursite.com/categories/%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2-XSS/"/>
    
    
      <category term="网络攻防" scheme="http://yoursite.com/tags/%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2/"/>
    
      <category term="XSS" scheme="http://yoursite.com/tags/XSS/"/>
    
  </entry>
  
</feed>
